sequenceDiagram
    participant User as User
    participant UI as UI
    participant GE as GameEngine
    participant LocalP as LocalNetworkPlayer
    participant Game as Game
    participant Board as Board
    participant Transport as TcpTransport

    activate GE
    GE->>LocalP: start_turn()
    activate LocalP
    LocalP->>UI: enable_input() via callback
    activate UI
    deactivate UI
    UI-->>LocalP:
    LocalP-->>GE:
    deactivate LocalP
    deactivate GE

    User->>UI: Enters move
    activate UI
    UI->>UI: Interpret & validate input
    UI->>UI: _apply_move(row, col)
    UI->>GE: apply_move(row, col)
    activate GE

    GE->>Game: apply_move(Move(symbol, row, col))
    activate Game
    Game->>Board: apply_move(move)
    activate Board
    Board->>Board: Validate move & update board
    Board-->>Game:
    deactivate Board
    Game->>Game: Switch current player
    Game-->>GE:
    deactivate Game
    GE->>LocalP: on_move_applied(row, col)
    activate LocalP
    LocalP->>Transport: send({"type": "move", "row": row, "col": col})
    activate Transport
    deactivate Transport
    Transport-->>LocalP:
    LocalP-->>GE:
    deactivate LocalP

    GE->>GE: _notify_board_updated()
    GE->>UI: on_board_updated() via callback
    activate UI
    UI->>UI: _render_board()
    UI->>User: Display updated board
    UI->>UI: Check if game over (winner/draw)
    UI-->>GE:
    deactivate UI

    GE->>GE: _start_next_turn()
    GE->>GE: Check if game over (winner/draw)
    note over GE: Start remote player's turn (noop)
    GE-->>UI: apply_move returns

    deactivate GE
    deactivate UI
