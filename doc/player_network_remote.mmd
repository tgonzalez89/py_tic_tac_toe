sequenceDiagram
    participant UI as UI
    participant GE as GameEngine
    participant RemoteP as RemoteNetworkPlayer
    participant Game as Game
    participant Board as Board
    participant Transport as TcpTransport

    activate Transport
    Transport->>Transport: Receive msg in _recv_loop()
    Transport->>Transport: _dispatch(msg)
    Transport->>RemoteP: _handle_move(msg) via registered handler callback
    activate RemoteP
    RemoteP->>RemoteP: Extract row, col from msg
    RemoteP->>GE: apply_move(row, col) via callback
    activate GE
    GE->>Game: apply_move(Move(symbol, row, col))
    activate Game
    Game->>Board: apply_move(move)
    activate Board
    Board->>Board: Validate move & update board
    Board-->>Game:
    deactivate Board
    Game->>Game: Switch current player
    Game-->>GE:
    deactivate Game

    GE->>GE: _notify_board_updated()
    GE->>UI: on_board_updated() via callback
    activate UI
    UI->>UI: _render_board()
    UI->>UI: Check if game over (winner/draw)
    UI-->>GE:
    deactivate UI

    GE->>GE: _start_next_turn()
    GE->>GE: Check if game over (winner/draw)
    note over GE: Start local player's turn
    GE-->>RemoteP: apply_move callback returns
    deactivate GE
    RemoteP-->>Transport: _handle_move callback returns
    deactivate RemoteP
    deactivate Transport
